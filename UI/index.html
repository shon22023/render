<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>タイムラプス勉強アプリ</title>
    <meta name="theme-color" content="#070A12">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
      <main class="stage" role="main" aria-label="タイムラプス">
        <div class="stageInner">
          <video id="video" class="video" src="video.mp4">ブラウザがビデオに対応していません！</video>
          <canvas id="canvas" class="canvas" width="854" height="480"></canvas>

          <!-- HUD: 常時表示は最小限（開始とMENU） -->
          <button id="sideBarButton" class="hudBtn hudBtnMenu" type="button" aria-haspopup="dialog" aria-expanded="false" aria-label="メニューを開く">
            <span class="hudIcon" aria-hidden="true">☰</span>
            <span class="srOnly">MENU</span>
          </button>

          <button id="videoButton" class="hudBtn hudBtnPrimary hudBtnStart" type="button" aria-label="録画を開始">
            <span class="hudIcon hudIconStart" aria-hidden="true">▶︎</span>
            <span class="srOnly">開始</span>
          </button>

          <div id="pauseFlash" class="pauseFlash" aria-hidden="true">⏸</div>
        </div>
      </main>
    </div>

    <!-- Sidebar -->
    <div id="sidebarOverlay" class="sidebarOverlay" aria-hidden="true"></div>
    <aside id="sidebar" class="sidebar" aria-label="メニュー" aria-hidden="true">
      <div class="sidebarHeader">
        <p class="sidebarTitle">メニュー</p>
        <button id="sidebarClose" class="btn btnSmall btnGhost" type="button" aria-label="閉じる">閉じる</button>
      </div>
      <div class="sidebarBody">
        <div class="sidebarRow">
          <span class="badge" id="statusBadge">
            <span class="dot" aria-hidden="true"></span>
            準備OK
          </span>
        </div>

        <section class="menuCard" aria-label="録画">
          <div class="menuCardTitle">録画</div>
          <button id="stopButton" class="btn btnGhost stopButton" type="button">一時停止</button>
          <button id="recordStopButton" class="btn btnDanger" type="button">録画終了</button>
        </section>

        <section class="menuCard" aria-label="動画アップロード">
          <div class="menuCardTitle">動画アップロード</div>
          <div id="uploadDropzone" class="dropzone" role="button" tabindex="0" aria-label="アップロード用ドロップゾーン">
            <div>
              <strong>ここにファイルをドロップ</strong><br>
              またはタップして選択
            </div>
          </div>
          <div class="fieldRow" style="margin-top:14px">
            <input id="uploadInput" type="file" accept="video/*" aria-label="アップロードする動画ファイル">
          </div>
          <div class="fileMeta">
            <span id="uploadMeta">未選択</span>
            <button id="uploadButton" class="btn btnSmall btnPrimary" type="button">アップロード</button>
          </div>
        </section>

        <nav class="nav" aria-label="その他">
          <a href="#" role="button" aria-disabled="true">詳細設定（準備中）</a>
          <a href="#" role="button" aria-disabled="true">利用規約（準備中）</a>
          <a href="#" role="button" aria-disabled="true">プライバシーポリシー（準備中）</a>
        </nav>
      </div>
    </aside>

    <!-- 既存JSが使用するダイアログ（id維持） -->
    <dialog id="modal" class="modal">
      <div class="dialogInner">
        <h2 class="dialogTitle">録画方法を選択してください</h2>
        <div class="dialogActions">
          <button id="cameraButton" class="btn btnPrimary cameraButton" type="button">カメラ</button>
          <button id="screenButton" class="btn btnPrimary screenButton" type="button">画面</button>
          <button id="pomoTimerButton" class="btn btnPrimary pomoTimerButton" type="button">ポモドーロ</button>
        </div>
      </div>
    </dialog>

    <dialog id="waitVideo" class="waitVideo">
      <div class="dialogInner">
        <h2 class="dialogTitle" id="waitVideoTitle">処理しています...</h2>
        <div id="loading" class="loading"><div class="spinner" aria-hidden="true"></div></div>
      </div>
    </dialog>

    <div id="toastHost" class="toastHost" aria-live="polite"></div>

    <script type="module" src="ui.js"></script>
    <script type="module" src="main.js"></script>
    <script type="module" src="timer.js"></script>
    <script type="module" src="pomoTimer.js"></script>
</body>
</html>
